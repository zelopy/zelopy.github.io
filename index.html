<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>부루마블 은행</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: 'Apple SD Gothic Neo', 'Noto Sans KR', sans-serif;
            background-color: #f8f9fa;
            min-height: 100vh;
            overflow: hidden;
        }
        .main-container {
            display: grid;
            grid-template-columns: 2fr 2fr 1fr;
            gap: 25px;
            height: calc(100vh - 40px);
        }
        .players-container {
            display: grid;
            grid-template-rows: 1fr 1fr;
            gap: 25px;
        }
        .player-section {
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            transition: transform 0.2s;
            min-height: 0; /* 높이 오버플로우 방지 */
        }
        .player-section:hover {
            transform: translateY(-3px);
        }
        /* 파스텔톤 배경색 */
        .player-section:nth-child(1) {
            background: linear-gradient(135deg, #FFE5E5 0%, #FFF5F5 100%);
        }
        .player-section:nth-child(2) {
            background: linear-gradient(135deg, #E5F3FF 0%, #F5FAFF 100%);
        }
        .player-section:nth-child(3) {
            background: linear-gradient(135deg, #E8FFE5 0%, #F6FFF5 100%);
        }
        .player-section:nth-child(4) {
            background: linear-gradient(135deg, #FFE5F9 0%, #FFF5FC 100%);
        }
        .balance {
            font-size: 32px;
            font-weight: bold;
            color: #2c3e50;
            margin: 15px 0;
            text-shadow: 1px 1px 0 rgba(255,255,255,0.5);
        }
        .controls {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .transfer-controls {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }
        button {
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.2s;
            white-space: nowrap;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .pay-bank {
            background-color: #FF9B9B;
            color: white;
        }
        .receive-bank {
            background-color: #94D494;
            color: white;
        }
        .transfer {
            background-color: #94B5D4;
            color: white;
        }
        select, input {
            padding: 10px;
            border: 2px solid rgba(0,0,0,0.1);
            border-radius: 8px;
            font-size: 14px;
            background-color: rgba(255,255,255,0.9);
            transition: all 0.2s;
        }
        select:focus, input:focus {
            outline: none;
            border-color: rgba(0,0,0,0.2);
            box-shadow: 0 0 0 3px rgba(0,0,0,0.05);
        }
        .transaction-history {
            background: rgba(255,255,255,0.95);
            padding: 15px;
            border-radius: 16px;
            overflow-y: auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            backdrop-filter: blur(10px);
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        .transaction-list {
            flex-grow: 1;
            overflow-y: auto;
        }
        .transaction-item {
            padding: 8px;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .transaction-item:hover {
            background-color: rgba(0,0,0,0.02);
        }
        .positive { color: #4CAF50; }
        .negative { color: #F44336; }
        h2 {
            margin: 0;
            color: #2c3e50;
            font-size: 24px;
            font-weight: 700;
        }
        h3 {
            color: #2c3e50;
            margin: 0 0 10px 0;
        }
        small {
            color: #666;
        }

        /* 반응형 디자인 */
        @media (max-width: 1200px) {
            .main-container {
                grid-template-columns: 1fr 1fr;
            }
            .transaction-history {
                grid-column: span 2;
                height: 200px;
            }
        }

        @media (max-width: 768px) {
            .main-container {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            .players-container {
                gap: 15px;
            }
            .player-section {
                padding: 15px;
            }
            .balance {
                font-size: 24px;
            }
            button {
                padding: 8px 12px;
            }
            .transaction-history {
                grid-column: span 1;
            }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <div class="players-container" id="players-left"></div>
        <div class="players-container" id="players-right"></div>
        <div class="transaction-history">
            <h3>거래 내역</h3>
            <div class="transaction-list" id="history"></div>
        </div>
    </div>

    <script>
        const STARTING_MONEY = 3000000;
        let players = [];
        let transactions = [];

        function initializePlayers() {
            for (let i = 1; i <= 4; i++) {
                players.push({
                    id: i,
                    name: `플레이어 ${i}`,
                    balance: STARTING_MONEY
                });
            }
            updateDisplay();
        }

        function updateDisplay() {
            const playersLeftDiv = document.getElementById('players-left');
            const playersRightDiv = document.getElementById('players-right');
            playersLeftDiv.innerHTML = '';
            playersRightDiv.innerHTML = '';
            
            players.forEach((player, index) => {
                const playerSection = document.createElement('div');
                playerSection.className = 'player-section';
                
                const otherPlayers = players
                    .filter(p => p.id !== player.id)
                    .map(p => `<option value="${p.id}">${p.name}</option>`)
                    .join('');

                playerSection.innerHTML = `
                    <h2>${player.name}</h2>
                    <div class="balance">${formatMoney(player.balance)}원</div>
                    <div class="controls">
                        <div class="bank-controls">
                            <input type="number" id="amount-${player.id}" placeholder="금액" style="width: 120px;">
                            <button class="receive-bank" onclick="receiveFromBank(${player.id})">은행에서 받기</button>
                            <button class="pay-bank" onclick="payToBank(${player.id})">은행에 지불</button>
                        </div>
                        <div class="transfer-controls">
                            <select id="transfer-to-${player.id}">
                                ${otherPlayers}
                            </select>
                            <button class="transfer" onclick="transferMoney(${player.id})">송금하기</button>
                        </div>
                    </div>
                `;

                // 플레이어 1,2는 왼쪽, 3,4는 오른쪽에 배치
                if (index < 2) {
                    playersLeftDiv.appendChild(playerSection);
                } else {
                    playersRightDiv.appendChild(playerSection);
                }
            });
        }

        function formatMoney(amount) {
            return amount.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }

        function receiveFromBank(playerId) {
            const amount = parseInt(document.getElementById(`amount-${playerId}`).value);
            if (!validateAmount(amount)) return;
            
            const player = players.find(p => p.id === playerId);
            player.balance += amount;
            addTransaction(player.name, amount, true, '은행');
            updateDisplay();
        }

        function payToBank(playerId) {
            const amount = parseInt(document.getElementById(`amount-${playerId}`).value);
            if (!validateAmount(amount)) return;
            
            const player = players.find(p => p.id === playerId);
            if (!validateBalance(player, amount)) return;
            
            player.balance -= amount;
            addTransaction(player.name, amount, false, '은행');
            updateDisplay();
        }

        function transferMoney(fromPlayerId) {
            const amount = parseInt(document.getElementById(`amount-${fromPlayerId}`).value);
            const toPlayerId = parseInt(document.getElementById(`transfer-to-${fromPlayerId}`).value);
            
            if (!validateAmount(amount)) return;
            
            const fromPlayer = players.find(p => p.id === fromPlayerId);
            const toPlayer = players.find(p => p.id === toPlayerId);
            
            if (!validateBalance(fromPlayer, amount)) return;
            
            fromPlayer.balance -= amount;
            toPlayer.balance += amount;
            
            addTransaction(fromPlayer.name, amount, false, toPlayer.name);
            updateDisplay();
        }

        function validateAmount(amount) {
            if (isNaN(amount) || amount <= 0) {
                alert('올바른 금액을 입력하세요');
                return false;
            }
            return true;
        }

        function validateBalance(player, amount) {
            if (player.balance < amount) {
                alert('잔액이 부족합니다!');
                return false;
            }
            return true;
        }

        function addTransaction(playerName, amount, isAddition, targetName) {
            const transaction = {
                playerName,
                targetName,
                amount,
                isAddition,
                timestamp: new Date()
            };
            transactions.unshift(transaction);
            updateHistory();
        }

        function updateHistory() {
            const historyDiv = document.getElementById('history');
            historyDiv.innerHTML = transactions.map(t => {
                let description;
                if (t.targetName === '은행') {
                    description = t.isAddition ? 
                        `${t.playerName}이(가) 은행에서 받음` :
                        `${t.playerName}이(가) 은행에 지불`;
                } else {
                    description = `${t.playerName}이(가) ${t.targetName}에게 송금`;
                }
                
                return `
                    <div class="transaction-item">
                        <span>${description}</span>
                        <span class="${t.isAddition ? 'positive' : 'negative'}">
                            ${t.isAddition ? '+' : '-'}${formatMoney(t.amount)}원
                        </span>
                        <small>(${t.timestamp.toLocaleTimeString()})</small>
                    </div>
                `;
            }).join('');
        }

        // 게임 시작 시 4명의 플레이어 초기화
        initializePlayers();
    </script>
</body>
</html>
